{"remainingRequest":"/Users/sabrina/project/微信点单小程序/manager/node_modules/ts-loader/index.js??ref--12-1!/Users/sabrina/project/微信点单小程序/manager/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/sabrina/project/微信点单小程序/manager/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/sabrina/project/微信点单小程序/manager/src/views/home/content/manageMenu/addMenu.vue?vue&type=script&lang=ts","dependencies":[{"path":"/Users/sabrina/project/微信点单小程序/manager/src/views/home/content/manageMenu/addMenu.vue","mtime":1623848287129},{"path":"/Users/sabrina/project/微信点单小程序/manager/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/sabrina/project/微信点单小程序/manager/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/Users/sabrina/project/微信点单小程序/manager/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/sabrina/project/微信点单小程序/manager/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19zcHJlYWRBcnJheXMgfSBmcm9tICJ0c2xpYiI7CmltcG9ydCB7IGRlZmluZUNvbXBvbmVudCwgcmVhY3RpdmUsIHJlZiwgZ2V0Q3VycmVudEluc3RhbmNlLCB9IGZyb20gInZ1ZSI7CmltcG9ydCB7IHRvUmF3IH0gZnJvbSAiQHZ1ZS9yZWFjdGl2aXR5IjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tICJ2dWV4IjsKZXhwb3J0IGRlZmF1bHQgZGVmaW5lQ29tcG9uZW50KHsKICAgIHNldHVwOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHN0b3JlID0gdXNlU3RvcmUoKTsKICAgICAgICB2YXIgY3R4ID0gZ2V0Q3VycmVudEluc3RhbmNlKCkuY3R4OwogICAgICAgIHZhciBhZGREaWFsb2dUYWJsZVZpc2libGUgPSByZWYoKTsgLy8gIOaWsOWinuiPnOWNleW8ueWHuuahhgogICAgICAgIC8v5paw5aKe6I+c5Y2V6KGo5Y2VCiAgICAgICAgdmFyIG5ld01lbnVEYXRhID0gcmVhY3RpdmUoewogICAgICAgICAgICBwaWN0dXJlOiAiIiwKICAgICAgICAgICAgbmFtZTogIiIsCiAgICAgICAgICAgIHByaWNlOiAiIiwKICAgICAgICAgICAgZGV0YWlsOiAiIiwKICAgICAgICB9KTsKICAgICAgICAvL+iPnOWNleWIl+ihqAogICAgICAgIGFkZERpYWxvZ1RhYmxlVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgICAgIC8vIOW8ueWHuuaWsOWinuiPnOWNleahhgogICAgICAgIHZhciBhZGRtZW51ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBhZGREaWFsb2dUYWJsZVZpc2libGUudmFsdWUgPSB0cnVlOwogICAgICAgIH07CiAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpOwogICAgICAgIC8v5LiK5Lyg5Zu+54mHCiAgICAgICAgdmFyIHVwbG9hZEltYWdlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygi5LiK5Lyg5Zu+54mHIik7CiAgICAgICAgICAgIHZhciBpbnB1dEltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbnB1dC1zdHlsZSIpOwogICAgICAgICAgICAvLyDljovnvKnlm77niYfpnIDopoHnmoTkuIDkupvlhYPntKDlkozlr7nosaEKICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAgIHZhciBmaWxlID0gbnVsbDsKICAgICAgICAgICAgLy8g5paH5Lu2YmFzZTY05YyW77yM5Lul5L6/6I6355+l5Zu+54mH5Y6f5aeL5bC65a+4CiAgICAgICAgICAgIGlucHV0SW1nLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBmaWxlID0gZS50YXJnZXQuZmlsZXNbMF07CiAgICAgICAgICAgICAgICAvLyDpgInmi6nnmoTmlofku7bmmK/lm77niYcKICAgICAgICAgICAgICAgIGlmIChmaWxlLnR5cGUuaW5kZXhPZigiaW1hZ2UiKSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAvL3JlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpO+i9rOeggeWujOavleaJp+ihjAogICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGltZy5zcmMgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgICAgICAvLyDkvb/mnKzlnLDlm77niYflnKjmtY/op4jlmajkuK3pooTop4gKICAgICAgICAgICAgICAgIHZhciBpbWdib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuYWRkLURpYWxvZy1sZWZ0LWJveCIpOwogICAgICAgICAgICAgICAgaW1nYm94LmlubmVySFRNTCA9CiAgICAgICAgICAgICAgICAgICAgJzxpbWcgc3R5bGU9ImhlaWdodDoyMDJweDt3aWR0aDoyMDJweCIgc3JjPSInICsKICAgICAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQucmVzdWx0ICsKICAgICAgICAgICAgICAgICAgICAgICAgJyI+JzsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGltZy5zcmMpOwogICAgICAgICAgICB9OwogICAgICAgIH07CiAgICAgICAgLy/lj5bmtojkuIrkvKAKICAgICAgICB2YXIgY2FuY2VsU3VibWl0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBhZGREaWFsb2dUYWJsZVZpc2libGUudmFsdWUgPSBmYWxzZTsKICAgICAgICB9OwogICAgICAgIC8v56Gu6K6k5LiK5LygCiAgICAgICAgdmFyIGNvbmZpcm1TdWJtaXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJjb25maXJtIHVwbG9hZCIsIGltZy5zcmMpOwogICAgICAgICAgICBuZXdNZW51RGF0YS5waWN0dXJlID0gaW1nLnNyYzsKICAgICAgICAgICAgYXhpb3MKICAgICAgICAgICAgICAgIC5wb3N0KCJodHRwOi8vbG9jYWxob3N0OjMwMDAvbWFuYWdlci9hZGRtZW51IiwgewogICAgICAgICAgICAgICAgbmV3TWVudURhdGE6IG5ld01lbnVEYXRhLAogICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgICAgICAgICAgIGFkZERpYWxvZ1RhYmxlVmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmVyciA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIGN0eC4kbWVzc2FnZS5zdWNjZXNzKCLmlrDlop7mlbDmja7miJDlip9+Iik7CiAgICAgICAgICAgICAgICAgICAgbmV3TWVudURhdGEucGljdHVyZSA9IHJlcy5kYXRhLm5ld1BpY1VybDsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygibmV3TWVudURhdGEgY2hhbmdlZCAiLCB0b1JhdyhuZXdNZW51RGF0YSkpOwogICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZURhdGEgPSB0b1JhdyhzdG9yZS5zdGF0ZS5tZW51TGlzdCk7CiAgICAgICAgICAgICAgICAgICAgc3RvcmUuY29tbWl0KCJtZW51TGlzdENoYW5nZWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3Q6IF9fc3ByZWFkQXJyYXlzKHRhYmxlRGF0YSwgW3RvUmF3KG5ld01lbnVEYXRhKV0pCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjdHguJG1lc3NhZ2Uuc3VjY2Vzcygi5paw5aKe5pWw5o2u5aSx6LSlfiIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgfSk7CiAgICAgICAgfTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBhZGREaWFsb2dUYWJsZVZpc2libGU6IGFkZERpYWxvZ1RhYmxlVmlzaWJsZSwKICAgICAgICAgICAgbmV3TWVudURhdGE6IG5ld01lbnVEYXRhLAogICAgICAgICAgICBhZGRtZW51OiBhZGRtZW51LAogICAgICAgICAgICB1cGxvYWRJbWFnZTogdXBsb2FkSW1hZ2UsCiAgICAgICAgICAgIGNhbmNlbFN1Ym1pdDogY2FuY2VsU3VibWl0LAogICAgICAgICAgICBjb25maXJtU3VibWl0OiBjb25maXJtU3VibWl0LAogICAgICAgIH07CiAgICB9LAp9KTsK"},{"version":3,"file":"/Users/sabrina/project/微信点单小程序/manager/src/views/home/content/manageMenu/addMenu.vue.ts","sourceRoot":"","sources":["/Users/sabrina/project/微信点单小程序/manager/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/sabrina/project/微信点单小程序/manager/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/sabrina/project/微信点单小程序/manager/src/views/home/content/manageMenu/addMenu.vue?vue&type=script&lang=ts"],"names":[],"mappings":"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","sourcesContent":["\r\nimport {\r\n  defineComponent,\r\n  reactive,\r\n  ref,\r\n  onMounted,\r\n  computed,\r\n  getCurrentInstance,\r\n} from \"vue\";\r\nimport { toRaw } from \"@vue/reactivity\";\r\nimport axios from \"axios\";\r\nimport { useStore } from \"vuex\";\r\nexport default defineComponent({\r\n  setup() {\r\n    const store = useStore();\r\n    const { ctx }: any = getCurrentInstance();\r\n    const addDialogTableVisible: any = ref(); //  新增菜单弹出框\r\n    //新增菜单表单\r\n    const newMenuData = reactive({\r\n      picture: \"\",\r\n      name: \"\",\r\n      price: \"\",\r\n      detail: \"\",\r\n    });\r\n    //菜单列表\r\n    \r\n    \r\n    \r\n    addDialogTableVisible.value = false;\r\n\r\n    // 弹出新增菜单框\r\n    const addmenu = () => {\r\n      addDialogTableVisible.value = true;\r\n    };\r\n    let img: any = new Image();\r\n    //上传图片\r\n    const uploadImage = () => {\r\n      console.log(\"上传图片\");\r\n      let inputImg: any = document.querySelector(\".input-style\");\r\n      // 压缩图片需要的一些元素和对象\r\n      let reader = new FileReader();\r\n\r\n      let file: any = null;\r\n\r\n      // 文件base64化，以便获知图片原始尺寸\r\n      inputImg.addEventListener(\"change\", function (e: any) {\r\n        file = e.target.files[0];\r\n        // 选择的文件是图片\r\n        if (file.type.indexOf(\"image\") == 0) {\r\n          reader.readAsDataURL(file);\r\n        }\r\n      });\r\n      //reader.readAsDataURL(file);转码完毕执行\r\n      reader.onload = function (e: any) {\r\n        img.src = e.target.result;\r\n        // 使本地图片在浏览器中预览\r\n        var imgbox: any = document.querySelector(\".add-Dialog-left-box\");\r\n        imgbox.innerHTML =\r\n          '<img style=\"height:202px;width:202px\" src=\"' +\r\n          e.target.result +\r\n          '\">';\r\n        // console.log(img.src);\r\n      };\r\n    };\r\n\r\n    //取消上传\r\n    const cancelSubmit = () => {\r\n      addDialogTableVisible.value = false;\r\n          \r\n\r\n    };\r\n    //确认上传\r\n    const confirmSubmit = () => {\r\n      // console.log(\"confirm upload\", img.src);\r\n      newMenuData.picture = img.src;\r\n      axios\r\n        .post(\"http://localhost:3000/manager/addmenu\", {\r\n          newMenuData,\r\n        })\r\n        .then(function (res) {\r\n          console.log(res);\r\n          addDialogTableVisible.value = false;\r\n          if (res.data.err == false) {\r\n            ctx.$message.success(\"新增数据成功~\");\r\n            newMenuData.picture = res.data.newPicUrl;\r\n            console.log (\"newMenuData changed \",toRaw(newMenuData))\r\n            let tableData = toRaw(store.state.menuList);\r\n            store.commit(\"menuListChanged\", {\r\n              list: [...tableData,...[toRaw(newMenuData)]]\r\n            }\r\n          \r\n            );\r\n          }\r\n          else{\r\n            ctx.$message.success(\"新增数据失败~\");\r\n          }\r\n        })\r\n        .catch(function (err) {});\r\n    };\r\n\r\n    return {\r\n      addDialogTableVisible,\r\n      newMenuData,\r\n      addmenu,\r\n      uploadImage,\r\n      cancelSubmit,\r\n      confirmSubmit,\r\n    };\r\n  },\r\n});\r\n"]}]}