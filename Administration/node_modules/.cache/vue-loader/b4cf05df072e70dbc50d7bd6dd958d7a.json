{"remainingRequest":"/Users/sabrina/project/微信点单小程序/manager/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/sabrina/project/微信点单小程序/manager/src/views/home/content/manageMenu/addMenu.vue?vue&type=style&index=0&id=3e9bea5e&scoped=true&lang=css","dependencies":[{"path":"/Users/sabrina/project/微信点单小程序/manager/src/views/home/content/manageMenu/addMenu.vue","mtime":1623848287129},{"path":"/Users/sabrina/project/微信点单小程序/manager/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/sabrina/project/微信点单小程序/manager/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":499162500000},{"path":"/Users/sabrina/project/微信点单小程序/manager/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/sabrina/project/微信点单小程序/manager/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/sabrina/project/微信点单小程序/manager/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouYWRkLXJvdyB7DQogIHBhZGRpbmc6IDBweCAwcHggMTBweCAxMHB4Ow0KfQ0KLmFkZC1EaWFsb2ctbGVmdCB7DQogIGRpc3BsYXk6IGZsZXg7DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KfQ0KLmFkZC1EaWFsb2ctbGVmdC1ib3ggew0KICB3aWR0aDogMjAwcHg7DQogIGhlaWdodDogMjAwcHg7DQogIC8qIGJhY2tncm91bmQ6ICM3M2I4ZmRmYSA7ICovDQogIGRpc3BsYXk6IGZsZXg7DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICBib3JkZXI6IDFweCBkYXNoZWQgcmdiKDE4NywgMTgyLCAxODIpOw0KfQ0KLmFkZC1EaWFsb2ctbGVmdC1ib3g6aG92ZXIgew0KICBib3JkZXI6IDFweCBkYXNoZWQgIzczYjhmZGZhOw0KfQ0KLmNhbmNlbC1idXR0b24gew0KICB0ZXh0LWFsaWduOiByaWdodDsNCn0NCi5zdWJtaXQtYnV0dG9uIHsNCiAgdGV4dC1hbGlnbjogbGVmdDsNCn0NCi5pbnB1dC1zdHlsZSB7DQogIHdpZHRoOiAxMDBweDsNCiAgaGVpZ2h0OiA0MHB4Ow0KICBwb3NpdGlvbjogYWJzb2x1dGU7DQogIG9wYWNpdHk6IDA7DQp9DQo="},{"version":3,"sources":["/Users/sabrina/project/微信点单小程序/manager/src/views/home/content/manageMenu/addMenu.vue"],"names":[],"mappings":"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","file":"/Users/sabrina/project/微信点单小程序/manager/src/views/home/content/manageMenu/addMenu.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <div>\r\n    <el-row class=\"add-row\">\r\n      <el-button type=\"primary\" @click=\"addmenu\">新增 </el-button>\r\n      <el-dialog title=\"新增菜品\" v-model=\"addDialogTableVisible\">\r\n        <el-row>\r\n          <el-col :span=\"12\" class=\"add-Dialog-left\">\r\n            <div class=\"add-Dialog-left-box\" @click=\"uploadImage()\">\r\n              <i class=\"iconfont icon-jia\"></i>\r\n              <input\r\n                type=\"file\"\r\n                name=\"file\"\r\n                accept=\"image/*\"\r\n                class=\"input-style\"\r\n              />\r\n            </div>\r\n          </el-col>\r\n          <el-col :span=\"12\" class=\"add-Dialog-right\">\r\n            <el-form :model=\"newMenuData\">\r\n              <el-form-item label=\"菜名\" width=\"120\">\r\n                <el-input\r\n                  v-model=\"newMenuData.name\"\r\n                  autocomplete=\"off\"\r\n                ></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"价格\" width=\"120\">\r\n                <el-input\r\n                  v-model=\"newMenuData.price\"\r\n                  autocomplete=\"off\"\r\n                ></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"详细说明\" width=\"120\">\r\n                <el-input\r\n                  v-model=\"newMenuData.detail\"\r\n                  autocomplete=\"off\"\r\n                ></el-input>\r\n              </el-form-item>\r\n            </el-form>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"12\" class=\"cancel-button\">\r\n            <el-button @click=\"cancelSubmit()\"> 取消 </el-button>\r\n          </el-col>\r\n          <el-col :span=\"12\" class=\"submit-button\">\r\n            <el-button @click=\"confirmSubmit()\"> 提交 </el-button>\r\n          </el-col>\r\n        </el-row>\r\n      </el-dialog>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n<script lang='ts'>\r\nimport {\r\n  defineComponent,\r\n  reactive,\r\n  ref,\r\n  onMounted,\r\n  computed,\r\n  getCurrentInstance,\r\n} from \"vue\";\r\nimport { toRaw } from \"@vue/reactivity\";\r\nimport axios from \"axios\";\r\nimport { useStore } from \"vuex\";\r\nexport default defineComponent({\r\n  setup() {\r\n    const store = useStore();\r\n    const { ctx }: any = getCurrentInstance();\r\n    const addDialogTableVisible: any = ref(); //  新增菜单弹出框\r\n    //新增菜单表单\r\n    const newMenuData = reactive({\r\n      picture: \"\",\r\n      name: \"\",\r\n      price: \"\",\r\n      detail: \"\",\r\n    });\r\n    //菜单列表\r\n    \r\n    \r\n    \r\n    addDialogTableVisible.value = false;\r\n\r\n    // 弹出新增菜单框\r\n    const addmenu = () => {\r\n      addDialogTableVisible.value = true;\r\n    };\r\n    let img: any = new Image();\r\n    //上传图片\r\n    const uploadImage = () => {\r\n      console.log(\"上传图片\");\r\n      let inputImg: any = document.querySelector(\".input-style\");\r\n      // 压缩图片需要的一些元素和对象\r\n      let reader = new FileReader();\r\n\r\n      let file: any = null;\r\n\r\n      // 文件base64化，以便获知图片原始尺寸\r\n      inputImg.addEventListener(\"change\", function (e: any) {\r\n        file = e.target.files[0];\r\n        // 选择的文件是图片\r\n        if (file.type.indexOf(\"image\") == 0) {\r\n          reader.readAsDataURL(file);\r\n        }\r\n      });\r\n      //reader.readAsDataURL(file);转码完毕执行\r\n      reader.onload = function (e: any) {\r\n        img.src = e.target.result;\r\n        // 使本地图片在浏览器中预览\r\n        var imgbox: any = document.querySelector(\".add-Dialog-left-box\");\r\n        imgbox.innerHTML =\r\n          '<img style=\"height:202px;width:202px\" src=\"' +\r\n          e.target.result +\r\n          '\">';\r\n        // console.log(img.src);\r\n      };\r\n    };\r\n\r\n    //取消上传\r\n    const cancelSubmit = () => {\r\n      addDialogTableVisible.value = false;\r\n          \r\n\r\n    };\r\n    //确认上传\r\n    const confirmSubmit = () => {\r\n      // console.log(\"confirm upload\", img.src);\r\n      newMenuData.picture = img.src;\r\n      axios\r\n        .post(\"http://localhost:3000/manager/addmenu\", {\r\n          newMenuData,\r\n        })\r\n        .then(function (res) {\r\n          console.log(res);\r\n          addDialogTableVisible.value = false;\r\n          if (res.data.err == false) {\r\n            ctx.$message.success(\"新增数据成功~\");\r\n            newMenuData.picture = res.data.newPicUrl;\r\n            console.log (\"newMenuData changed \",toRaw(newMenuData))\r\n            let tableData = toRaw(store.state.menuList);\r\n            store.commit(\"menuListChanged\", {\r\n              list: [...tableData,...[toRaw(newMenuData)]]\r\n            }\r\n          \r\n            );\r\n          }\r\n          else{\r\n            ctx.$message.success(\"新增数据失败~\");\r\n          }\r\n        })\r\n        .catch(function (err) {});\r\n    };\r\n\r\n    return {\r\n      addDialogTableVisible,\r\n      newMenuData,\r\n      addmenu,\r\n      uploadImage,\r\n      cancelSubmit,\r\n      confirmSubmit,\r\n    };\r\n  },\r\n});\r\n</script>\r\n<style scoped>\r\n.add-row {\r\n  padding: 0px 0px 10px 10px;\r\n}\r\n.add-Dialog-left {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n.add-Dialog-left-box {\r\n  width: 200px;\r\n  height: 200px;\r\n  /* background: #73b8fdfa ; */\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border: 1px dashed rgb(187, 182, 182);\r\n}\r\n.add-Dialog-left-box:hover {\r\n  border: 1px dashed #73b8fdfa;\r\n}\r\n.cancel-button {\r\n  text-align: right;\r\n}\r\n.submit-button {\r\n  text-align: left;\r\n}\r\n.input-style {\r\n  width: 100px;\r\n  height: 40px;\r\n  position: absolute;\r\n  opacity: 0;\r\n}\r\n</style>"]}]}